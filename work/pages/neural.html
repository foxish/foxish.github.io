<!DOCTYPE HTML>
<!--
	Prologue by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Learn. Research. Engineer.</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="../assets/css/main.css" />
		<!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
		<!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
		<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/gist-embed/2.4/gist-embed.min.js"></script>
	</head>
	<body>
		<!-- Main -->
			<div id="main">
				<section>
				    <header>
						<h2>Building a Neural Network from First Principles</h2>
						<a href="/work" title="Back to the Home page"><b>Back to Home Page</b></a>
					</header>
				</section>
					<div class="container">
						<p>
						    I have wanted to understand neural networks well for 
						    a long time now. What better way to learn them than 
						    to build one from first principles. I define a simple problem
						    first in the following section, start with how one 
						    can implement the perceptron algorithm to solve that 
						    problem in a simple and self-describing manner, and finally
						    conclude with further refinements.
						</p>
						
						<p>
						    <h3>Part 1: A simple problem</h3>
						    This is <a href="https://en.wikipedia.org/wiki/Perfect_information">perfect information game</a>.
						    We begin with exact two doors and two players. 
						    The game lasts two moves and in each move, the player 
						    must pick one door. The game may end in a draw if the two 
						    players pick different doors. However, if one player 
						    picks a door that has already been chosen by a different 
						    player in his turn, that is recorded as a loss. Both 
						    players can see the door chosen by their opponent. 
						    
						    In order to illustrated this, we label the two doors 
						    0 and 1. The following represents the outcomes when player 0 plays first
						    and is followed by player 1, with player 0 always being the user, and player 1
						    being the AI. <br/><br/>
						    
                            <style type="text/css">
                            .tg  {border-collapse:collapse;border-spacing:0;}
                            .tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
                            .tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
                            .tg .tg-yw4l{vertical-align:top}
                            @media screen and (max-width: 767px) {.tg {width: auto !important;}.tg col {width: auto !important;}.tg-wrap {overflow-x: auto;-webkit-overflow-scrolling: touch;margin: auto 0px;}}</style>
                            <div class="tg-wrap"><table class="tg">
                              <tr>
                                <th class="tg-yw4l">Player 1</th>
                                <th class="tg-yw4l">Player 2</th>
                                <th class="tg-yw4l">Outcome</th>
                              </tr>
                              <tr>
                                <td class="tg-yw4l">0</td>
                                <td class="tg-yw4l">0</td>
                                <td class="tg-yw4l">Player 1 wins</td>
                              </tr>
                              <tr>
                                <td class="tg-yw4l">0</td>
                                <td class="tg-yw4l">1</td>
                                <td class="tg-yw4l">Draw</td>
                              </tr>
                              <tr>
                                <td class="tg-yw4l">1</td>
                                <td class="tg-yw4l">0</td>
                                <td class="tg-yw4l">Draw</td>
                              </tr>
                              <tr>
                                <td class="tg-yw4l">1</td>
                                <td class="tg-yw4l">1</td>
                                <td class="tg-yw4l">Player 1 wins</td>
                              </tr>
                            </table></div>
                            The above is evidence that we are looking to realize the negation
						    function. 
						</p>
						<p>
						    <h3>Part 1: A simple neural network</h3>
						    First, we assume that the AI always plays second, just to simplify
						    the problem even further.
						    
						    We need one input and a single output as per our above definition.
						    In a neural network of this size however, we need one 
						    <a href="https://en.wikipedia.org/wiki/Artificial_neuron"
						    target="_blank">artificial neuron</a>. Hence, we have 
						    with two binary inputs, one held constantly at 1, and the other
						    being the position of the door chosen by the first player. 
						    The desired output is the door to be chosen by the AI player.
						    We represent the two inputs as x0 and x1, and the lone output
						    as s. The initial weights are set to 0 on both neurons. <br/><br/>
						
						    <script type="text/javascript">
                                String.prototype.format = String.prototype.f = function() {
                                    var s = this,
                                        i = arguments.length;
                                
                                    while (i--) {
                                        s = s.replace(new RegExp('\\{' + i + '\\}', 'gm'), arguments[i]);
                                    }
                                    return s;
                                };
                                
                                var Perceptron = function () {
                                  // initialize both weights to 0.
                                  this.w0 = 0;
                                  this.w1 = 0;
                                
                                  // learning rate
                                  this.learn_rate = 0.08;
                                
                                  // the bias neuron
                                  this.x0 = 1;
                                
                                  this.train = function(x1, z) {
                                    var error = (z - this.predict(x1));
                                    var correction = this.learn_rate * error;
                                    this.w0 = this.w0 + this.x0*correction;
                                    this.w1 = this.w1 + x1*correction;
                                    
                                  }
                                  this.predict = function(x1) {
                                    return (this.w0*this.x0 + this.w1*x1) <= 0.5 ? 0 : 1;
                                  }
                                };
                                
                                var p = new Perceptron();
                                function play(door){
                                	var ai_choice = p.predict(door);
                                  var outcome = undefined;
                                  if (ai_choice === door) {
                                  	// ai loses
                                    p.train(ai_choice, !door);
                                    outcome = false;
                                  } else {
                                  	// ai does not lose
                                    p.train(ai_choice, door);
                                    outcome = true;
                                  }
                                  $('#game tr:last').after('<tr><td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td><td>{4}</td></tr>'.format(door, ai_choice, outcome ? "draw" : "loss", p.w0, p.w1));
                                  return outcome;
                                }
						    </script>
                        </p>
                        <p>
                            <h3>Part 2: A running example.</h3>
                            <style type="text/css">
                                .tg  {border-collapse:collapse;border-spacing:0;max-width:500px;}
                                .tg td{font-family:Arial, sans-serif;font-size:14px;padding:1px 2px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
                                .tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:1px 2px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;}
                                .tg .tg-yw4l{vertical-align:top}
                                @media screen and (max-width: 767px) {.tg {width: auto !important;}.tg col {width: auto !important;}.tg-wrap {overflow-x: auto;-webkit-overflow-scrolling: touch;margin: auto 0px;}}</style>
                                <div class="tg-wrap"><table class="tg" id="game">
                                  <tr>
                                    <th class="tg-yw4l">You chose</th>
                                    <th class="tg-yw4l">AI chose</th>
                                    <th class="tg-yw4l">Outcome</th>
                                    <th class="tg-yw4l">w1</th>
                                    <th class="tg-yw4l">w2</th>
                                  </tr>
                            </table></div>
						    <table style="max-width:500px;">
						        <tr>
						           <td><img src="../images/door.png" onclick="javascript:play(0); return false;"> Door 0 </td>
						           <td><img src="../images/door.png" onclick="javascript:play(1); return false;"> Door 1 </td>
						        </tr>
						    </table>
						    Click either of the two doors to play. You are player 1. <br/>
						</p>
						
						<p>
						    <h3>Part 3: Code</h3>
						As can be seen, the AI hits a steady state as time progresses and stops losing. At that point, it has successfully
						learned the NOT function. The algorithm I used in this example is the <a href="https://en.wikipedia.org/wiki/Perceptron" target="_blank"></a>perceptron, one of the oldest
						and simplest.
						
						The underlying code is:
					       <code data-gist-id="a57e855aced96f755639"></code>
						
						
						The interesting parts are in perceptron.js. The play function is simply hooked up to each of the
						images and serves to display results and train the model as we go. The effect of the learning rate and so 
						on can be experimentally determined on this <a href="https://jsfiddle.net/anirudh4444/3f7qqhen/2/" target="_blank">JSFiddle</a>.
					</p>
					<p>
					  <h3>Part 4: Conceptual Understanding</h3>
					  Coming soon...
					</p>
					<div id="disqus_thread"></div>
			</div>
			<section>
				<a href="/work" title="Back to the Home page"><b>Back to Home Page</b></a> | <a href="#" title="To the top of this page"><b>Back to Top</b></a>
			</section>
		<!-- Scripts -->
			<script src="../assets/js/jquery.min.js"></script>
			<script src="../assets/js/jquery.scrolly.min.js"></script>
			<script src="../assets/js/jquery.scrollzer.min.js"></script>
			<script src="../assets/js/skel.min.js"></script>
			<script src="../assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="../assets/js/ie/respond.min.js"></script><![endif]-->
			<script>
				  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
				  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
				  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
				  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
				
				  ga('create', 'UA-73284504-1', 'auto');
				  ga('send', 'pageview');
			</script>
			<script>
				var disqus_config = function () {
				this.page.url = "http://foxish.github.io/work/pages/neural.html"; // Replace PAGE_URL with your page's canonical URL variable
				this.page.identifier = "neural"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
				};
				(function() { // DON'T EDIT BELOW THIS LINE
				var d = document, s = d.createElement('script');
				
				s.src = '//learnresearchengineer.disqus.com/embed.js';
				
				s.setAttribute('data-timestamp', +new Date());
				(d.head || d.body).appendChild(s);
				})();
			</script>
			<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
			<script id="dsq-count-scr" src="//learnresearchengineer.disqus.com/count.js" async></script>
	</body>
</html>